<!DOCTYPE html>
<html>
<head>
		<meta charset="utf-8">
	
	<title>DFS: Properties cannot be set on the namespace server - Access is denied</title>
	
	
	<meta name="description" content="How to fix the &quot;properties cannot be set on the namespace server&quot; &quot;Access is denied&quot; error on a Distributed File System (DFS) share.">
	
	<meta name="author" content="Brian Scholer">

	<!-- Enable responsive viewport -->
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
	<!--[if lt IE 9]>
	<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->

	<!-- Le styles -->
	<link href="/assets/resources/bootstrap/css/bootstrap.min.css" rel="stylesheet">
	<link href="/assets/resources/font-awesome/css/font-awesome.min.css" rel="stylesheet">
	<link href="/assets/resources/syntax/syntax.css" rel="stylesheet">
	<link href="/assets/css/style.css" rel="stylesheet">
	<link href="/assets/css/slimbox2.css" rel="stylesheet">

	<!-- Le fav and touch icons -->
	<!-- Update these with your own images
	<link rel="shortcut icon" href="images/favicon.ico">
	<link rel="apple-touch-icon" href="images/apple-touch-icon.png">
	<link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
	-->

	<link rel="alternate" type="application/rss+xml" title="" href="/feed.xml">
	
	<!-- Asynchronous Google Analytics snippet -->
	<script>
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'bs-UA-34696009-1', 'auto');
	ga('send', 'pageview');
	</script>
	<script async src='https://www.google-analytics.com/analytics.js'></script>
	
</head>

<body>
	<nav class="navbar navbar-default visible-xs" role="navigation">
		<!-- Brand and toggle get grouped for better mobile display -->
		<div class="navbar-header">
			<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
				<span class="sr-only">Toggle navigation</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			
			<a type="button" class="navbar-toggle nav-link" href="http://github.com/briantist">
				<i class="fa fa-github"></i>
			</a>
			
			
			<a type="button" class="navbar-toggle nav-link" href="http://twitter.com/BrianScholer">
				<i class="fa fa-twitter"></i>
			</a>
			
			
			<a type="button" class="navbar-toggle nav-link" href="mailto:brian@briantist.com">
				<i class="fa fa-envelope"></i>
			</a>
			
			<a class="navbar-brand" href="/">
				<img src="//www.gravatar.com/avatar/c54d4c111c4564b116ff1efca8c56788?s=35" class="img-circle" />
				briantist.com
			</a>
		</div>

		<!-- Collect the nav links, forms, and other content for toggling -->
		<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
			<ul class="nav navbar-nav">
				<li class="active"><a href="/"><i class="fa fa-home"></i>&nbsp;Home</a></li>
				
				
				
				
				<li><a href="/about-me/"><i class="fa fa-user"></i>&nbsp;About</a></li>
				
				
				
				<li><a href="/contact-me/"><i class="fa fa-envelope"></i>&nbsp;Contact</a></li>
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
			</ul>
		</div><!-- /.navbar-collapse -->
	</nav>

	<!-- nav-menu-dropdown -->
	<div class="btn-group hidden-xs" id="nav-menu">
		<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
			<i class="fa fa-bars"></i>
		</button>
		<ul class="dropdown-menu" role="menu">
			<li><a href="/"><i class="fa fa-home"></i>Home</a></li>
			
			
			
			
			<li><a href="/about-me/"><i class="fa fa-user"></i>About</a></li>
			
			
			
			<li><a href="/contact-me/"><i class="fa fa-envelope"></i>Contact</a></li>
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			<li class="divider"></li>
			<li><a href="#"><i class="fa fa-arrow-up"></i>Top of Page</a></li>
		</ul>
	</div>

	<div class="col-sm-3 sidebar hidden-xs">
		<!-- sidebar.html -->
<header class="sidebar-header" role="banner">
	<a href="/">
		<img src="//www.gravatar.com/avatar/c54d4c111c4564b116ff1efca8c56788?s=150" class="img-circle" />
	</a>
	<h3 class="title">
        <a href="/">briantist.com</a>
    </h3>
</header>



<div id="description" class="text-center">
	Four million lines of BASIC
</div>


<div id="contact-list" class="text-center">
	<ul class="list-unstyled list-inline">
		
		<li>
			<a class="btn btn-default btn-sm" href="https://github.com/briantist">
				<i class="fa fa-github-alt fa-2x"></i>
			</a>
		</li>
		
		
		<li>
			<a class="btn btn-default btn-sm" href="https://twitter.com/BrianScholer">
				<i class="fa fa-twitter fa-2x"></i>
			</a>
		</li>
		
		
		<li>
			<a class="btn btn-default btn-sm" href="mailto:brian@briantist.com">
				<i class="fa fa-envelope fa-2x"></i>
			</a>
		</li>
		
	</ul>
	<ul id="contact-list-secondary" class="list-unstyled list-inline">
		
		
		<li>
			<a class="btn btn-default btn-sm" href="http://stackoverflow.com/users/3905079/briantist">
				<i class="fa fa-stack-overflow fa-2x"></i>
			</a>
		</li>
		
		
		<li>
			<a class="btn btn-default btn-sm" href="https://linkedin.com/in/bscholer">
				<i class="fa fa-linkedin fa-2x"></i>
			</a>
		</li>
		
		<li>
			<a class="btn btn-default btn-sm" href="/feed.xml">
				<i class="fa fa-rss fa-2x"></i>
			</a>
		</li>
	</ul>
	
	
</div>
<!-- sidebar.html end -->

	</div>

	<div class="col-sm-9 col-sm-offset-3">
		<div class="page-header">
  <h1>DFS: Properties cannot be set on the namespace server - Access is denied </h1>
</div>
	
<article>

	<div class="col-sm-10">
		 <div class="byline">
		
			
		
		<time datetime="2012-11-16T21:41:49-05:00"><i class="fa fa-calendar"></i>
		November 16, 2012
		 </time>
		
		
		
		 <span class="comment-count"><i class="fa fa-comment"></i> <a data-disqus-identifier="17a315da-6885-410c-b1b8-1322e7af9ede" href="#disqus_thread">Comments</a></span>
	</div>
	
			 

	  <div class="article_body">
	  <p>I ran across a strange problem the other day with DFS. I needed to override the referral ordering for a namespace server, but the change wouldn’t take. I got a status of Error during the <em>Commit changes</em> task. In the detail, it showed <code>Properties cannot be set on the namespace server \\SERVER.domain.local\Share. Access is denied</code>.</p>

<p><a href="/images/post/dfs-properties-cannot-be-set-namespace-server-access-denied/dfs-access-is-denied-namespace-server.png" rel="lightbox-dfs" title="Properties cannot be set on the namespace server - Access is denied"><img src="/images/post/dfs-properties-cannot-be-set-namespace-server-access-denied/dfs-access-is-denied-namespace-server.png" alt="Properties cannot be set on the namespace server - Access is denied" /></a></p>

<p>This error must be uncommon, because all of the search results are for a similar but differently worded error about changing the properties of a <em>folder</em> and that issue’s resolutions don’t apply here.</p>

<p>I finally figured out the problem, and thought I’d share!</p>

<a name="more"></a>

<h2 id="the-root-of-the-problem">The Root of the Problem</h2>

<p>If you looked at the other search results and forum postings and Microsoft KB articles, you probably went around and checked permissions on the target folders. If you’re here by now, then you know that it wasn’t the problem.</p>

<p>Actually, this issue doesn’t live on any of the individual namespace servers. Instead it’s a permissions problem in the Active Directory objects used to store information about the DFS shares. The computer object for each namespace server in a namespace will have some permissions granted on that namespace’s object in AD.</p>

<p>In my case, one of the computers was missing (I suspect that this was a side-effect of a swing migration, as the missing computer was a secondary domain controller that was demoted and then re-promoted after the migration, but that’s another story).</p>

<p>It’s worth noting that this prevented me from changing the referral ordering of another namespace server as well, so even if the ACL looks to be in order for the one you’re trying to change, <strong>it’s important to check the ACLs for every namespace server.</strong></p>

<h2 id="the-easy-fix">The Easy Fix?</h2>

<p>You could blow away the whole DFS share and start fresh. That should fix the problem. Of course, if you run into errors deleting it, you might have to forcefully delete it, then use <code>dfsutil.exe</code> to clean up the left over registry entries.</p>

<p>Plus, in my case at least, the DFS share worked just fine. I really didn’t want to bring the share down, or worry about cleaning up leftovers.</p>

<h2 id="the-easy-enough-fix">The Easy Enough Fix</h2>

<p>Since the problem lives in Active Directory, you’ll be making changes to AD itself. We’ll be using ADSI Edit, so hop onto a Domain Controller or a machine with the ADSI Edit RSAT. There’s no need to make this change from a namespace server on the DFS share.</p>

<p>You should also have a complete list of the namespace servers for the share.</p>

<h3 id="use-adsi-edit-to-view-the-dfs-configuration">Use ADSI Edit to view the DFS configuration</h3>

<ol>
  <li>
    <p>In ADSI Edit, connect to <code>Default naming context</code>.</p>
  </li>
  <li>
    <p>Browse to <code>DC=ABCD,DC=local</code> &gt; <code>CN=System</code> &gt; <code>CN=Dfs-Configuration</code></p>
  </li>
  <li>
    <p>Here, you’ll see a list of your DFS shares: <code>CN=ShareName</code><br />
<br />
<a href="/images/post/dfs-properties-cannot-be-set-namespace-server-access-denied/adsi-edit-system-dfs-configuration.png" rel="lightbox-dfs" title="ADSI Edit &gt; CN=System &gt; CN=Dfs-Configuration"><img src="/images/post/dfs-properties-cannot-be-set-namespace-server-access-denied/adsi-edit-system-dfs-configuration-300x194.png" alt="ADSI Edit &gt; CN=System &gt; CN=Dfs-Configuration" />
</a></p>
  </li>
  <li>
    <p>Open the Properties of the affected share. In the first tab (<strong>Attribute Editor</strong>), look for the <code>remoteServerName</code> field.<br />
<br />
<a href="/images/post/dfs-properties-cannot-be-set-namespace-server-access-denied/ftdfs-attribute-remoteservername.png" rel="lightbox-dfs" title="fTDFS remoteServerName attribute"><img src="/images/post/dfs-properties-cannot-be-set-namespace-server-access-denied/ftdfs-attribute-remoteservername-268x300.png" alt="fTDFS remoteServerName attribute" />
</a><br />
<br />
This contains the list of all the namespace servers that AD has listed. Make sure this matches what is shown in the DFS management console. If it doesn’t, you might have bigger problems, and you may need to resort to the “easy” fix.</p>
  </li>
  <li>
    <p>Now you can switch over to the <strong>Security</strong> tab. Click the <strong>Advanced </strong>button so that you see all the entries and the special permissions.  <br />
<br />
<a href="/images/post/dfs-properties-cannot-be-set-namespace-server-access-denied/ftdfs-advanced-security-missing-computer.png" rel="lightbox-dfs" title="Advanced Security Settings - Account Unknown"><img src="/images/post/dfs-properties-cannot-be-set-namespace-server-access-denied/ftdfs-advanced-security-missing-computer-300x246.png" alt="Advanced Security Settings - Account Unknown" /></a><br />
<br />
Looking at the entries for the computer objects (the ones with the <code>$</code> at the end), we can see that they all have the <code>Read/write all properties</code> access. In this example, you’ll also see a missing object, listed as <code>Account Unknown(S-ID-xxx)</code> with the same access as the other computers, so it’s a good bet that this is the missing one.</p>
  </li>
</ol>

<hr />

<p><strong>Please note that I took these screenshots after I fixed the issue. In the above, <code>STORAGE01$</code> is not missing, but in the subsequent screens, I use it as the example machine I am adding. I hope it’s not confusing!</strong></p>

<hr />

<h3 id="find-the-missing-namespace-server-and-add-it-back">Find the missing namespace server and add it back</h3>

<ol>
  <li>
    <p>In the <strong>Advanced Security</strong> dialog above, click the <strong>Add</strong> button.</p>
  </li>
  <li>
    <p>In the <strong>Select…</strong> dialog, click <strong>Object Types…</strong> and make sure that <code>Computers</code> is selected. Click <strong>OK</strong>.</p>
  </li>
  <li>
    <p>Now choose the computer that was missing from the list, and click <strong>OK</strong>.  <br />
<br />
<a href="/images/post/dfs-properties-cannot-be-set-namespace-server-access-denied/permissions-dialog-include-computer-objects.png" rel="lightbox-dfs" title="Select User, Computer, Service Account, or Group Dialog"><img src="/images/post/dfs-properties-cannot-be-set-namespace-server-access-denied/permissions-dialog-include-computer-objects-300x164.png" alt="Select User, Computer, Service Account, or Group Dialog" /></a>\</p>
  </li>
  <li>
    <dl>
      <dt>Next, you want to give the computer object the  <code>Read all properties</code> and <code>Write all properties</code> Permissions. You can leave the <em>Properties</em> alone or clear them all in advance, as I did. By default, other <em>Permissions</em> may be granted, but only the two listed should be kept.</dt>
      <dd><strong>Server 2012 Dialog:</strong><br />
<a href="/images/post/dfs-properties-cannot-be-set-namespace-server-access-denied/ftdfs-permissions-entry-properties-server-2012.png" rel="lightbox-dfs" title="Advanced Permission Entry on Server 2012"><img src="/images/post/dfs-properties-cannot-be-set-namespace-server-access-denied/ftdfs-permissions-entry-properties-server-2012-300x193.png" alt="Advanced Permission Entry on Server 2012" /></a></dd>
      <dd><strong>Server 2008 R2 (and earlier) Dialog:</strong><br />
<a href="/images/post/dfs-properties-cannot-be-set-namespace-server-access-denied/ftdfs-permissions-entry-pre-2012.png" rel="lightbox-dfs" title="Advanced Permissions Entry 2008 2003"><img src="/images/post/dfs-properties-cannot-be-set-namespace-server-access-denied/ftdfs-permissions-entry-pre-2012-235x300.png" alt="Advanced Permissions Entry 2008 2003" />
</a></dd>
    </dl>
  </li>
</ol>

<h2 id="wait-then-test">Wait, Then Test</h2>

<p>Once the changes are made, wait until they have had time to replicate to all DCs. It can be difficult to tell which DC you’re hitting when you try to make administrative changes with DFS, so best to wait until all of them have the same information. You could force replication if you prefer.</p>

<p>When you’re sure it’s all synchronized, test it out. I didn’t run into any issues after this.</p>

<h2 id="unsolved-mysteries">Unsolved Mysteries</h2>

<p>I still don’t know exactly how that computer went missing. As I said, there was some turmoil due to a previous swing migration, but the share was working fine. Stranger still, other DFS shares had the same namespace server missing in the ACLs, yet they had no problem making changes to their properties (like the referral ordering). Seems like they should be broken.</p>

<p>Please let me know if you had success (or not) with this procedure!</p>

	  </div>
                    

		
		<ul class="list-inline">
		  <li><i class="fa fa-tags"></i></li>
		  
		  
			 
				<li>
					<a href="/tag/dfs/">
					dfs <span>(1)</span>
					
					</a>
				</li>
			
		  
		  
		</ul>
		  

		<hr>

		<div>
      <section class="share col-sm-6">
        <h4 class="section-title">Share Post</h4>
        <a class="btn btn-default btn-sm twitter" href="http://twitter.com/share?text=DFS: Properties cannot be set on the namespace server - Access is denied&via=BrianScholer"
           onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
          <i class="fa fa-twitter fa-lg"></i>
          Twitter
        </a>
        <a class="btn btn-default btn-sm facebook" href="https://www.facebook.com/sharer/sharer.php"
           onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
          <i class="fa fa-facebook fa-lg"></i>
          Facebook
        </a>
        <a class="btn btn-default btn-sm gplus"
           onclick="window.open('https://plus.google.com/share?url='+window.location.href, 'google-plus-share', 'width=490,height=530');return false;">
          <i class="fa fa-google-plus fa-lg"></i>
          Google+
        </a>
      </section>

      
    </div>

    <div class="clearfix"></div>

		<ul class="pager">
		  
		  <li class="previous"><a href="/how-to/jtds-ntlm-auth-confluence-sql-server/" title="Use jTDS NTLM Authentication in Confluence with SQL Server">&larr; Previous</a></li>
		  
		  
		  <li class="next"><a href="/how-to/hide-pages-404-genesis-theme-wordpress/" title="Hide Pages from the 404 Page in a Genesis Wordpress Theme">Next &rarr;</a></li>
		  
		</ul>

		<hr>
	</div>
	
	<div class="col-sm-2 sidebar-2">
	
	</div>
</article>
<div class="clearfix"></div>



    
<div id="disqus_thread"></div>


<script>
    /**
     *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
     *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
     */
    var disqus_config = function () {
        this.page.url = 'https://www.briantist.com/errors/dfs-properties-cannot-be-set-namespace-server-access-denied/';  /* Replace PAGE_URL with your page's canonical URL variable */
        this.page.identifier = '17a315da-6885-410c-b1b8-1322e7af9ede'; /* Replace PAGE_IDENTIFIER with your page's unique identifier variable */
    };
    (function() {  /* DON'T EDIT BELOW THIS LINE */
        var d = document, s = d.createElement('script');
        
        s.src = '//briantist.disqus.com/embed.js';
        
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

 <script id="dsq-count-scr" src="//briantist.disqus.com/count.js" async></script>





		<footer>
			<hr/>
			<p>
				&copy; 2012 &ndash; 2015 Brian Scholer &nbsp;&middot;&nbsp; <a rel="nofollow" target="_blank" href="https://cloudflare.ipv6-test.com/validate.php?url=www.briantist.com"><img src="https://ajax.cloudflare.com/cdn-cgi/custom/images/button-ipv6-80x15.png" alt="ipv6 ready" title="ipv6 ready" border="0" style="vertical-align: middle;" width="80" height="15" /></a>
			</p>
		</footer>
	</div>

	<script type="text/javascript" src="/assets/resources/jquery/jquery.min.js"></script>
	<script type="text/javascript" src="/assets/resources/slimbox2/slimbox2.js"></script>
	<script type="text/javascript" src="/assets/resources/bootstrap/js/bootstrap.min.js"></script>
	
</body>
</html>
