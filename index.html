<!DOCTYPE html>
<html>
<head>
		<meta charset="utf-8">
	
	<title>briantist.com</title>
	
	
	<meta name="author" content="Brian Scholer">

	<!-- Enable responsive viewport -->
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
	<!--[if lt IE 9]>
	<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->

	<!-- Le styles -->
	<link href="/assets/resources/bootstrap/css/bootstrap.min.css" rel="stylesheet">
	<link href="/assets/resources/font-awesome/css/font-awesome.min.css" rel="stylesheet">
	<link href="/assets/resources/syntax/syntax.css" rel="stylesheet">
	<link href="/assets/css/style.css" rel="stylesheet">
	<link href="/assets/css/slimbox2.css" rel="stylesheet">

	<!-- Le fav and touch icons -->
	<!-- Update these with your own images
	<link rel="shortcut icon" href="images/favicon.ico">
	<link rel="apple-touch-icon" href="images/apple-touch-icon.png">
	<link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
	-->

	<link rel="alternate" type="application/rss+xml" title="" href="/feed.xml">
	
	<!-- Asynchronous Google Analytics snippet -->
	<script>
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-34696009-1', 'auto');
	ga('send', 'pageview');
	</script>
	<script async src='https://www.google-analytics.com/analytics.js'></script>
	
		<script>
	var _prum = [['id', '562d90a9abe53df309cbda7d'],
		     ['mark', 'firstbyte', (new Date()).getTime()]];
	(function() {
	    var s = document.getElementsByTagName('script')[0]
	      , p = document.createElement('script');
	    p.async = 'async';
	    p.src = '//rum-static.pingdom.net/prum.min.js';
	    s.parentNode.insertBefore(p, s);
	})();
	</script>
</head>

<body>
	<nav class="navbar navbar-default visible-xs" role="navigation">
		<!-- Brand and toggle get grouped for better mobile display -->
		<div class="navbar-header">
			<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
				<span class="sr-only">Toggle navigation</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			
			<a type="button" class="navbar-toggle nav-link" href="http://github.com/briantist">
				<i class="fa fa-github"></i>
			</a>
			
			
			<a type="button" class="navbar-toggle nav-link" href="http://twitter.com/BrianScholer">
				<i class="fa fa-twitter"></i>
			</a>
			
			
			<a type="button" class="navbar-toggle nav-link" href="mailto:brian@briantist.com">
				<i class="fa fa-envelope"></i>
			</a>
			
			<a class="navbar-brand" href="/">
				<img src="//www.gravatar.com/avatar/c54d4c111c4564b116ff1efca8c56788?s=35" class="img-circle" />
				briantist.com
			</a>
		</div>

		<!-- Collect the nav links, forms, and other content for toggling -->
		<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
			<ul class="nav navbar-nav">
				<li class="active"><a href="/"><i class="fa fa-home"></i>&nbsp;Home</a></li>
				
				
				
				
				<li><a href="/about-me/"><i class="fa fa-user"></i>&nbsp;About</a></li>
				
				
				
				<li><a href="/contact-me/"><i class="fa fa-envelope"></i>&nbsp;Contact</a></li>
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
			</ul>
		</div><!-- /.navbar-collapse -->
	</nav>

	<!-- nav-menu-dropdown -->
	<div class="btn-group hidden-xs" id="nav-menu">
		<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
			<i class="fa fa-bars"></i>
		</button>
		<ul class="dropdown-menu" role="menu">
			<li><a href="/"><i class="fa fa-home"></i>Home</a></li>
			
			
			
			
			<li><a href="/about-me/"><i class="fa fa-user"></i>About</a></li>
			
			
			
			<li><a href="/contact-me/"><i class="fa fa-envelope"></i>Contact</a></li>
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			<li class="divider"></li>
			<li><a href="#"><i class="fa fa-arrow-up"></i>Top of Page</a></li>
		</ul>
	</div>

	<div class="col-sm-3 sidebar hidden-xs">
		<!-- sidebar.html -->
<header class="sidebar-header" role="banner">
	<a href="/">
		<img src="//www.gravatar.com/avatar/c54d4c111c4564b116ff1efca8c56788?s=150" class="img-circle" />
	</a>
	<h3 class="title">
        <a href="/">briantist.com</a>
    </h3>
</header>



<div id="description" class="text-center">
	Four million lines of BASIC
</div>


<div id="contact-list" class="text-center">
	<ul class="list-unstyled list-inline">
		
		<li>
			<a class="btn btn-default btn-sm" href="https://github.com/briantist">
				<i class="fa fa-github-alt fa-2x"></i>
			</a>
		</li>
		
		
		<li>
			<a class="btn btn-default btn-sm" href="https://twitter.com/BrianScholer">
				<i class="fa fa-twitter fa-2x"></i>
			</a>
		</li>
		
		
		<li>
			<a class="btn btn-default btn-sm" href="mailto:brian@briantist.com">
				<i class="fa fa-envelope fa-2x"></i>
			</a>
		</li>
		
	</ul>
	<ul id="contact-list-secondary" class="list-unstyled list-inline">
		
		
		<li>
			<a class="btn btn-default btn-sm" href="http://stackoverflow.com/users/3905079/briantist">
				<i class="fa fa-stack-overflow fa-2x"></i>
			</a>
		</li>
		
		
		<li>
			<a class="btn btn-default btn-sm" href="https://linkedin.com/in/bscholer">
				<i class="fa fa-linkedin fa-2x"></i>
			</a>
		</li>
		
		<li>
			<a class="btn btn-default btn-sm" href="/feed.xml">
				<i class="fa fa-rss fa-2x"></i>
			</a>
		</li>
	</ul>
	
	
</div>
<!-- sidebar.html end -->

	</div>

	<div class="col-sm-9 col-sm-offset-3">
		<div class="page-header">
  <h1>briantist.com </h1>
</div>
<div class="page-content">

<article class="home">
  <h2>
    <a href="/how-to/throw-exception-on-unbound-mandatory-powershell-parameter/">Throw an Exception Instead of Prompt for an Unsupplied Mandatory PowerShell Parameter</a>
  </h2>
   	 <div class="byline">
		
		<time datetime="2015-11-08T00:00:00-05:00"><i class="fa fa-calendar"></i>
		November 08, 2015
		 </time>
		
		 <span class="comment-count"><i class="fa fa-comment"></i> <a data-disqus-identifier="7b8acbeb-de99-44c7-b56d-c0db5b8b65a8" href="/how-to/throw-exception-on-unbound-mandatory-powershell-parameter/#disqus_thread">Comments</a></span>
		 
	</div>
	
			 


  <div class="post-content">
    
    
    <p>I came across <a href="http://stackoverflow.com/q/33600279/3905079" target="_blank">this question on StackOverflow about <code>throw</code>ing when a parameter is not supplied by pipeline <i class="fa fa-stack-overflow"></i></a>. There have been many questions about this (without so much emphasis on the pipeline), so it seems to be a common request that PowerShell not prompt on a missing mandatory parameter, but instead <code>throw</code> an exception.</p>

<p>The short answer is that there is no way to do it if the parameter is in fact mandatory, so what we usually settle for is a simulation of required-ness that’s usually handled with a default value expression that <code>throw</code>s an exception, like so:</p>

<figure class="highlight"><pre><code class="language-powershell" data-lang="powershell"><span class="k">function</span> <span class="nb">Get-Thing</span> <span class="p">{</span>
<span class="p">[</span><span class="k">CmdletBinding</span><span class="p">()]</span>
<span class="k">param</span><span class="p">(</span>
    <span class="nv">$MyParam</span> <span class="p">=</span> <span class="p">$(</span> <span class="k">throw</span> <span class="s1">&#39;MyParam is required&#39;</span> <span class="p">)</span>
<span class="p">)</span>
<span class="p">}</span></code></pre></figure>

<p>But this approach has its disadvantages.</p>

<a class="read-more" href="/how-to/throw-exception-on-unbound-mandatory-powershell-parameter/#more">Continue Reading &raquo;</a>
    
    
  </div>

</article>

<article class="home">
  <h2>
    <a href="/how-to/use-duplicate-dsc-script-resources-in-loop/">Use Variables in a DSC Script Resource</a>
  </h2>
   	 <div class="byline">
		
		<time datetime="2015-11-06T19:41:00-05:00"><i class="fa fa-calendar"></i>
		November 06, 2015
		 </time>
		
		 <span class="comment-count"><i class="fa fa-comment"></i> <a data-disqus-identifier="a83baaa5-badf-41b5-9f19-fd9473b2c75e" href="/how-to/use-duplicate-dsc-script-resources-in-loop/#disqus_thread">Comments</a></span>
		 
	</div>
	
			 


  <div class="post-content">
    
    
    
<p>Every PowerShell Desired State Configuration resource must have at least one <code>Key</code> property that’s used to uniquely identify it within a single configuration. For the <a href="https://technet.microsoft.com/en-us/library/dn282130.aspx" target="_blank">DSC <code>Script</code> Resource</a> the keys are the <code>GetScript</code>, <code>TestScript</code>, and <code>SetScript</code> properties. Basically this means that each <code>Script</code> resource can’t contain the same content. Makes sense on the surface, but when you consider variable substitution, and looping through collections in <code>$ConfigurationData</code>, it’s easy to come up with a configuration that ends up with this error:</p>

<blockquote>
  <p>Add-NodeKeys : The key properties combination ‘<em>your script here</em>’ is duplicated for keys ‘GetScript,SetScript,TestScript’ of resource ‘Script’ in node ‘<em>nodename</em>’. Please make sure key properties are unique for each resource in a node.</p>
</blockquote>

<p>This is quite annoying, but there are ways around it so you don’t have to resort to manually unrolling your loop.</p>

<a class="read-more" href="/how-to/use-duplicate-dsc-script-resources-in-loop/#more">Continue Reading &raquo;</a>
    
    
  </div>

</article>

<article class="home">
  <h2>
    <a href="/errors/could-not-establish-trust-relationship-for-the-ssltls-secure-channel/">Could not establish trust relationship for the SSL/TLS secure channel</a>
  </h2>
   	 <div class="byline">
		
		<time datetime="2015-08-17T18:40:33-04:00"><i class="fa fa-calendar"></i>
		August 17, 2015
		 </time>
		
		 <span class="comment-count"><i class="fa fa-comment"></i> <a data-disqus-identifier="4b360992-2ad8-47b6-a433-8b51b8b29c00" href="/errors/could-not-establish-trust-relationship-for-the-ssltls-secure-channel/#disqus_thread">Comments</a></span>
		 
	</div>
	
			 


  <div class="post-content">
    
    
    <p>Sometimes we run web services internally that don’t use a trusted SSL certificate. It’s not good practice, but in the real world this will be encountered.</p>

<p>In PowerShell, we often see this error come up when using <code class="highlight language-powershell" data-lang="powershell"><span class="nb">Invoke-WebRequest</span></code> or <code class="highlight language-powershell" data-lang="powershell"><span class="nb">Invoke-RestMethod</span></code> or even the <code class="highlight language-powershell" data-lang="powershell"><span class="no">[System.Net.WebClient]</span></code> class. All of these rely on the .Net framework which is set up to validate SSL certificates, so an exception gets thrown when we try to connect to a site over SSL that isn’t trusted.</p>

<p>For a while, a lot of people created a class that implemented the <code>ICertificatePolicy</code> interface, provided a method that always returned true, and then set <code class="highlight language-csharp" data-lang="csharp"><span class="n">System</span><span class="p">.</span><span class="n">Net</span><span class="p">.</span><span class="n">ServicePointManager</span><span class="p">.</span><span class="n">CertificatePolicy</span></code> to an instance of the new class. This is also the method I have used for a while, and in PowerShell it didn’t seem to complain. But I’ve recently found that <a href="http://stackoverflow.com/q/18454292/3905079" target="_blank" rel="nofollow">this method is in fact deprecated <i class="fa fa-stack-overflow"></i></a>.</p>

<p>It seems the correct way is to set the <code class="highlight language-csharp" data-lang="csharp"><span class="n">ServicePointManager</span><span class="p">.</span><span class="n">ServerCertificateValidationCallback</span></code> property to a callback function. Ok, no problem. It’s almost the same thing.</p>

<a class="read-more" href="/errors/could-not-establish-trust-relationship-for-the-ssltls-secure-channel/#more">Continue Reading &raquo;</a>
    
    
  </div>

</article>

<article class="home">
  <h2>
    <a href="/how-to/test-for-verbose-in-powershell/">Test for Verbose in Powershell</a>
  </h2>
   	 <div class="byline">
		
		<time datetime="2014-12-22T15:21:21-05:00"><i class="fa fa-calendar"></i>
		December 22, 2014
		 </time>
		
		 <span class="comment-count"><i class="fa fa-comment"></i> <a data-disqus-identifier="73d3fad2-11b7-4802-9648-4c3f763979cc" href="/how-to/test-for-verbose-in-powershell/#disqus_thread">Comments</a></span>
		 
	</div>
	
			 


  <div class="post-content">
    
    
    <p>I was looking for a way to determine whether I was in Verbose mode in Powershell. My web searches came up with various solutions that all suffer from problems. Most of them use <code class="highlight language-powershell" data-lang="powershell"><span class="nv">$PSBoundParameters</span></code>. The most obvious problem with this is that it only works when <code class="highlight language-powershell" data-lang="powershell"><span class="n">-Verbose</span></code> was called directly on the script or function whose context you’re currently in. Since the Verbose state is inherited by child scopes, this is less than ideal.</p>

<a class="read-more" href="/how-to/test-for-verbose-in-powershell/#more">Continue Reading &raquo;</a>
    
    
  </div>

</article>

<article class="home">
  <h2>
    <a href="/how-to/splatting-psboundparameters-default-values-optional-parameters/">Splatting with $PSBoundParameters and Default Values for Optional Parameters</a>
  </h2>
   	 <div class="byline">
		
		<time datetime="2014-09-09T19:05:10-04:00"><i class="fa fa-calendar"></i>
		September 09, 2014
		 </time>
		
		 <span class="comment-count"><i class="fa fa-comment"></i> <a data-disqus-identifier="45672ac2-38b8-40e5-be6b-b3583371f206" href="/how-to/splatting-psboundparameters-default-values-optional-parameters/#disqus_thread">Comments</a></span>
		 
	</div>
	
			 


  <div class="post-content">
    
    
    <p>Splatting is a really great feature in PowerShell that lets you take a <code class="highlight language-powershell" data-lang="powershell"><span class="no">[hashtable]</span></code> of parameters and call a function or cmdlet with the hash instead of having to type out every parameter name and value. It seems natural then that if you’re writing a wrapper or proxy function, where your function takes the same or nearly the same parameters as the function you’re calling, you could use <code class="highlight language-powershell" data-lang="powershell"><span class="nv">$PSBoundParameters</span></code> to do the heavy lifting (this special variable contains all of the parameter values passed into the function).</p>

<p>The problem comes when your proxy function has defaults for its optional parameters. <code class="highlight language-powershell" data-lang="powershell"><span class="nv">$PSBoundParameters</span></code> only includes the values of parameters that were <em>explicitly supplied by the caller.</em> There is no such variable that contains the default values.</p>

<a class="read-more" href="/how-to/splatting-psboundparameters-default-values-optional-parameters/#more">Continue Reading &raquo;</a>
    
    
  </div>

</article>

<article class="home">
  <h2>
    <a href="/errors/dns-manager-cant-set-txt-record-to-expire/">DNS Manager Can't Set TXT Record to Expire</a>
  </h2>
   	 <div class="byline">
		
		<time datetime="2014-08-25T20:34:26-04:00"><i class="fa fa-calendar"></i>
		August 25, 2014
		 </time>
		
		 <span class="comment-count"><i class="fa fa-comment"></i> <a data-disqus-identifier="0462bf6f-ca52-42e4-b967-9d4393bdf94c" href="/errors/dns-manager-cant-set-txt-record-to-expire/#disqus_thread">Comments</a></span>
		 
	</div>
	
			 


  <div class="post-content">
    
    
    <p>I finally got DNS scavenging configured in our environment. It’s working great, no big disasters. I was browsing the DNS manager (so much faster now that we got rid of those 6,000+ resource records we didn’t need) and I noticed two <code>TXT</code> records that I created as a test last week. I didn’t need them anymore, but instead of deleting them I thought I’d just set them to expire and let scavenging take care of it. Funny thing is, the setting just wouldn’t stick. No errors, nothing preventing me from doing it, it just kept reverting to static.</p>

<a class="read-more" href="/errors/dns-manager-cant-set-txt-record-to-expire/#more">Continue Reading &raquo;</a>
    
    
  </div>

</article>

<article class="home">
  <h2>
    <a href="/errors/get-dnsserverresourcerecord-returns-duplicate-records-when-sub-domain-matching-zone-exists/">Get-DnsServerResourceRecord returns duplicate records when a sub-domain matching the zone exists</a>
  </h2>
   	 <div class="byline">
		
		<time datetime="2014-08-05T17:43:19-04:00"><i class="fa fa-calendar"></i>
		August 05, 2014
		 </time>
		
		 <span class="comment-count"><i class="fa fa-comment"></i> <a data-disqus-identifier="8988bb0b-761a-4715-86fd-8a8a9acd0870" href="/errors/get-dnsserverresourcerecord-returns-duplicate-records-when-sub-domain-matching-zone-exists/#disqus_thread">Comments</a></span>
		 
	</div>
	
			 


  <div class="post-content">
    
    
    <p>While writing a PowerShell script to fix some DNS records, I came across some very strange behavior. I was calling <code class="highlight language-powershell" data-lang="powershell"><span class="nb">Get-DnsServerResourceRecord</span></code> and it was returning duplicate results for every record. One result was correct, and the other one looked like it was the fully qualified domain name. The results made no sense to me, and I couldn’t figure out how now to return these extraneous records.</p>

<a class="read-more" href="/errors/get-dnsserverresourcerecord-returns-duplicate-records-when-sub-domain-matching-zone-exists/#more">Continue Reading &raquo;</a>
    
    
  </div>

</article>

<article class="home">
  <h2>
    <a href="/how-to/get-progress-dfs-replication-database-cloning-import/">Get Progress on DFS Replication Database Cloning Import</a>
  </h2>
   	 <div class="byline">
		
		<time datetime="2014-04-04T16:42:05-04:00"><i class="fa fa-calendar"></i>
		April 04, 2014
		 </time>
		
		 <span class="comment-count"><i class="fa fa-comment"></i> <a data-disqus-identifier="0ad50611-7997-475c-9600-77136b83dc34" href="/how-to/get-progress-dfs-replication-database-cloning-import/#disqus_thread">Comments</a></span>
		 
	</div>
	
			 


  <div class="post-content">
    
    
    <p>As I wrote in a <a href="/errors/dfsr-database-cloning-import-fails-0x1129-4393-tag-reparse-point-buffer-invalid/">previous post</a>, I began using the new DFS Replication database cloning technique to speed up initial sync. Thanks to <a href="http://blogs.technet.com/b/filecab/archive/2013/08/21/dfs-replication-initial-sync-in-windows-server-2012-r2-attack-of-the-clones.aspx" target="_blank">Ned Pyle’s great How-To on the subject</a>, I was able to tell exactly which events to look for in the event log to get an idea of progress: <code>2412</code> for the start of the process, <code>2416</code> for progress, <code>2404</code> for successful finish, and <code>2418</code> for an unsuccessful end (found that one out on my own, whoops!).</p>

<p>Since I clearly had a few hours to kill while the import happened, I wrote up a quick script to show the progress, with estimated time remaining.</p>

<a class="read-more" href="/how-to/get-progress-dfs-replication-database-cloning-import/#more">Continue Reading &raquo;</a>
    
    
  </div>

</article>

<article class="home">
  <h2>
    <a href="/errors/dfsr-database-cloning-import-fails-0x1129-4393-tag-reparse-point-buffer-invalid/">DFSR Database Cloning Import Fails - 0x00001129 - Error 4393 - The tag present in the reparse point buffer is invalid</a>
  </h2>
   	 <div class="byline">
		
		<time datetime="2014-04-04T15:53:08-04:00"><i class="fa fa-calendar"></i>
		April 04, 2014
		 </time>
		
		 <span class="comment-count"><i class="fa fa-comment"></i> <a data-disqus-identifier="054990fa-390e-4cce-bd75-97ea7014fd3b" href="/errors/dfsr-database-cloning-import-fails-0x1129-4393-tag-reparse-point-buffer-invalid/#disqus_thread">Comments</a></span>
		 
	</div>
	
			 


  <div class="post-content">
    
    
    <p>Windows 2012 R2 introduces a great feature for speeding up DFS Replication initial sync: Database Cloning. The details are covered very well by <a href="http://blogs.technet.com/b/filecab/archive/2013/08/21/dfs-replication-initial-sync-in-windows-server-2012-r2-attack-of-the-clones.aspx" target="_blank">Ned Pyle’s excellent blog posts, especially this one</a>. Seeing as how this is pretty new stuff, there doesn’t seem to be a lot of documentation about the possible errors, and I encountered the one in the title.</p>

<a class="read-more" href="/errors/dfsr-database-cloning-import-fails-0x1129-4393-tag-reparse-point-buffer-invalid/#more">Continue Reading &raquo;</a>
    
    
  </div>

</article>

<article class="home">
  <h2>
    <a href="/errors/remote-desktop-gateway-server-temporarily-unavailable-sbs-2011-after-uninstalling-exchange-server/">Remote Desktop Gateway Server is Temporarily Unavailable on SBS 2011 After Uninstalling Exchange Server</a>
  </h2>
   	 <div class="byline">
		
		<time datetime="2014-02-12T19:30:07-05:00"><i class="fa fa-calendar"></i>
		February 12, 2014
		 </time>
		
		 <span class="comment-count"><i class="fa fa-comment"></i> <a data-disqus-identifier="28aee44b-a10c-430a-a87b-1084e73928ca" href="/errors/remote-desktop-gateway-server-temporarily-unavailable-sbs-2011-after-uninstalling-exchange-server/#disqus_thread">Comments</a></span>
		 
	</div>
	
			 


  <div class="post-content">
    
    
    <p>There are several causes of the error “Your computer can’t connect to the remote computer because the remote desktop gateway server is temporarily unavailable” in Windows SBS 2011. There are a lot of articles that deal with the specifics so I’ll go over those more common causes briefly before explaining my issue (which related to uninstalling Exchange).</p>

<a class="read-more" href="/errors/remote-desktop-gateway-server-temporarily-unavailable-sbs-2011-after-uninstalling-exchange-server/#more">Continue Reading &raquo;</a>
    
    
  </div>

</article>

<article class="home">
  <h2>
    <a href="/how-to/configure-confluence-smtp-tls-jndi-office-365-relay/">Configure Confluence SMTP with TLS via JNDI for Office 365 Relay</a>
  </h2>
   	 <div class="byline">
		
		<time datetime="2013-12-08T23:58:21-05:00"><i class="fa fa-calendar"></i>
		December 08, 2013
		 </time>
		
		 <span class="comment-count"><i class="fa fa-comment"></i> <a data-disqus-identifier="f5062a60-5dab-47fa-933f-bfd55e013bf8" href="/how-to/configure-confluence-smtp-tls-jndi-office-365-relay/#disqus_thread">Comments</a></span>
		 
	</div>
	
			 


  <div class="post-content">
    
    
    <p>or</p>

<h2 id="how-to-fixjavaxnetsslsslexception-unrecognized-ssl-message-plaintext-connection-in-confluence-jndi">How To Fix: javax.net.ssl.SSLException: Unrecognized SSL message, plaintext connection in Confluence JNDI</h2>

<p>I’ve been doing Exchange to Office 365 migrations lately and that means on-premises applications and devices can’t use the local Exchange server to send mail anymore.</p>

<p>Your options are to use the credentials of an Office 365 mailbox to send mail, set up a local SMTP relayer, or use a third-party SMTP service.</p>

<p>If you’ve opted to use an Office 365 login to send mail via SMTP, then you must use TLS, so the applications/devices sending mail must support sending mail with TLS on port 587.</p>

<p>This article focuses on Atlassian Confluence but may apply to other java applications using JNDI to configure mail.</p>

<h2 id="atlassian-confluence-secure-smtp-and-jndi">Atlassian Confluence, Secure SMTP, and JNDI</h2>

<p>Confluence has no way to set up secure SMTP with SSL or TLS from within the administration, so unfortunately you’re forced to configure Confluence to use a JNDI Location for SMTP. This involves moving around JARs and changing configuration files, which will end up slowing down your upgrades (see my script to <a href="/how-to/confluence-jira-windows-upgrades/">make Confluence upgrades easier</a>).</p>

<a class="read-more" href="/how-to/configure-confluence-smtp-tls-jndi-office-365-relay/#more">Continue Reading &raquo;</a>
    
    
  </div>

</article>

<article class="home">
  <h2>
    <a href="/errors/junk-mail-not-syncing-android-exchange-activesync/">Junk Mail Not Syncing on Android Exchange ActiveSync</a>
  </h2>
   	 <div class="byline">
		
		<time datetime="2013-09-29T20:10:59-04:00"><i class="fa fa-calendar"></i>
		September 29, 2013
		 </time>
		
		 <span class="comment-count"><i class="fa fa-comment"></i> <a data-disqus-identifier="c9ee83c8-7f59-48e5-9b56-e4486994c9c5" href="/errors/junk-mail-not-syncing-android-exchange-activesync/#disqus_thread">Comments</a></span>
		 
	</div>
	
			 


  <div class="post-content">
    
    
    <p><a href="/images/post/junk-mail-not-syncing-android-exchange-activesync/2013-09-29-19.55.30.png" rel="lightbox-android-junk" title="Junk Email - No Messages"><img src="/images/post/junk-mail-not-syncing-android-exchange-activesync/2013-09-29-19.55.30-150x150.png" alt="Junk Email - No Messages" /></a></p>

<p>I was asked recently to look at an Android phone that was connected to Exchange via ActiveSync. It was working fine for regular email, but Junk mail was seemingly not coming through.</p>

<p>Doesn’t sound like too bad a problem to have, but if you have clients (or worse, <em>prospective</em> clients) end up in Junk mail from time to time, and you don’t know it, it can seem like you’re ignoring them. Not good!</p>

<a class="read-more" href="/errors/junk-mail-not-syncing-android-exchange-activesync/#more">Continue Reading &raquo;</a>
    
    
  </div>

</article>

<article class="home">
  <h2>
    <a href="/errors/failed-to-clone-the-repository-github-for-windows/">Failed to clone the repository in GitHub for Windows</a>
  </h2>
   	 <div class="byline">
		
		<time datetime="2013-09-09T00:34:26-04:00"><i class="fa fa-calendar"></i>
		September 09, 2013
		 </time>
		
		 <span class="comment-count"><i class="fa fa-comment"></i> <a data-disqus-identifier="f8d52ad9-f45c-4fe9-9cdb-8779e21e7cd8" href="/errors/failed-to-clone-the-repository-github-for-windows/#disqus_thread">Comments</a></span>
		 
	</div>
	
			 


  <div class="post-content">
    
    
    <p><img src="/images/post/failed-to-clone-the-repository-github-for-windows/failed-to-clone-the-repository-please-check-your-internet-connection.png" alt="failed-to-clone-the-repository-please-check-your-internet-connection" /></p>

<p>I recently installed GitHub for Windows for the first time so I could compile an open source project. While trying to clone the repository, I got this error:</p>

<blockquote>
  <p>failed to clone the repository ‘<em>whatever</em>’<br />
Please check your internet connection.</p>
</blockquote>

<p>I knew my internet connection was working. A web search revealed answers that didn’t apply or didn’t work for me (an issue that was resolved in an earlier version, and an issue that was fixed by re-installing).</p>

<a class="read-more" href="/errors/failed-to-clone-the-repository-github-for-windows/#more">Continue Reading &raquo;</a>
    
    
  </div>

</article>

<article class="home">
  <h2>
    <a href="/errors/scheduled-task-powershell-0xfffd0000/">Last Result of 0xFFFD0000 for Powershell Scheduled Task</a>
  </h2>
   	 <div class="byline">
		
		<time datetime="2013-06-06T19:16:45-04:00"><i class="fa fa-calendar"></i>
		June 06, 2013
		 </time>
		
		 <span class="comment-count"><i class="fa fa-comment"></i> <a data-disqus-identifier="2b87f878-3444-4265-8a8c-336ea40baea3" href="/errors/scheduled-task-powershell-0xfffd0000/#disqus_thread">Comments</a></span>
		 
	</div>
	
			 


  <div class="post-content">
    
    
    <p>In my environment I push out a scheduled task which runs a PowerShell script. The PowerShell script sits on a network share. Recently, we changed the share where our scripts are stored, and as a result we updated the task to point to the new script location. The task used to work, but now it throws a Last Run Result error, with the return code <code>0xFFFD0000</code>.</p>

<a class="read-more" href="/errors/scheduled-task-powershell-0xfffd0000/#more">Continue Reading &raquo;</a>
    
    
  </div>

</article>

<article class="home">
  <h2>
    <a href="/errors/server-2012-vmware-esxi-permissions-errors-removable-storage-auditing/">Windows Server 2012, VMware ESXi, and Strange Permissions Errors - Removable Storage Auditing what?</a>
  </h2>
   	 <div class="byline">
		
		<time datetime="2013-04-08T20:46:13-04:00"><i class="fa fa-calendar"></i>
		April 08, 2013
		 </time>
		
		 <span class="comment-count"><i class="fa fa-comment"></i> <a data-disqus-identifier="81ce00e1-8972-4c57-ad81-0978eb75535c" href="/errors/server-2012-vmware-esxi-permissions-errors-removable-storage-auditing/#disqus_thread">Comments</a></span>
		 
	</div>
	
			 


  <div class="post-content">
    
    
    <p><strong>Update:</strong> There is now an <a href="https://support.microsoft.com/en-us/kb/2811670" target="_blank">update available via KB2811670 from Microsoft</a> to address this (<a href="#comment-2290082797">thanks Owen</a>).</p>

<p>I’ve been getting ready to roll out Windows Server 2012 to be used for new production hosts, and one of the first machines I tried to deploy was a web server. I created my VM, installed Windows 2012, got IIS all set up. This web site was to be used for uploading and serving files, so I added a data disk and put the web site on this drive. The web app runs on Perl so I installed that, configured it, and no matter what I kept getting <code>500.19</code> errors. I don’t set up Perl all that often on IIS, and I thought for sure that it must have been some quirk in the process that I was missing.</p>

<p>Instead it turned out to be an unholy combination of factors with the way that VMware presents disk drives to Windows and how Windows 8 / Server 2012 handles removable drives. It effects things other than IIS too. The symptoms are strange, the errors are unhelpful, and the fixes aren’t obvious.</p>

<a class="read-more" href="/errors/server-2012-vmware-esxi-permissions-errors-removable-storage-auditing/#more">Continue Reading &raquo;</a>
    
    
  </div>

</article>

<article class="home">
  <h2>
    <a href="/how-to/missing-computers-eset-nod32-remote-install/">Missing Computers in ESET NOD32 Remote Install Tab</a>
  </h2>
   	 <div class="byline">
		
		<time datetime="2012-12-23T01:18:07-05:00"><i class="fa fa-calendar"></i>
		December 23, 2012
		 </time>
		
		 <span class="comment-count"><i class="fa fa-comment"></i> <a data-disqus-identifier="602d5ffd-27ca-4d9f-bed7-368adec1eae8" href="/how-to/missing-computers-eset-nod32-remote-install/#disqus_thread">Comments</a></span>
		 
	</div>
	
			 


  <div class="post-content">
    
    
    <p>The ESET Remote Administrator Console hasn’t caused me much grief over the years when it comes to pushing out installations. But recently I was helping a client upgrade the workstations to version 5 of NOD32, now called ESET Endpoint Antivirus, or ESET Smart Security. Things seemed to be going fine, but then I noticed that at least 2 computers were not in the <code>Remote Install</code> tab’s computer list.</p>

<a class="read-more" href="/how-to/missing-computers-eset-nod32-remote-install/#more">Continue Reading &raquo;</a>
    
    
  </div>

</article>

<article class="home">
  <h2>
    <a href="/how-to/hide-pages-404-genesis-theme-wordpress/">Hide Pages from the 404 Page in a Genesis Wordpress Theme</a>
  </h2>
   	 <div class="byline">
		
		<time datetime="2012-11-23T17:30:55-05:00"><i class="fa fa-calendar"></i>
		November 23, 2012
		 </time>
		
		 <span class="comment-count"><i class="fa fa-comment"></i> <a data-disqus-identifier="a1f0f061-ba1d-419a-8c4d-81c7843bddd0" href="/how-to/hide-pages-404-genesis-theme-wordpress/#disqus_thread">Comments</a></span>
		 
	</div>
	
			 


  <div class="post-content">
    
    
    
<p>If you run your Wordpress blog on the wonderful <a href="http://www.shareasale.com/r.cfm?B=346200&amp;U=704608&amp;M=28169&amp;urllink=" rel="nofollow" target="_blank" onClick="ga('send', 'event', 'Product', 'click', 'StudioPress');">Genesis Framework</a> (as I <s>do</s> did), then you know that the 404 page is pretty nice out of the box. It gives the user a way back to the homepage, and lists of Pages and Posts and all kinds of ways to get people to find the content they wanted.</p>

<p><a href="/images/post/hide-pages-404-genesis-theme-wordpress/wordpress-genesis-theme-404-page.png" rel="lightbox-genesis404" title="Wordpress Genesis Theme 404 Page"><img src="/images/post/hide-pages-404-genesis-theme-wordpress/wordpress-genesis-theme-404-page-300x231.png" alt="Wordpress Genesis Theme 404 Page" /></a></p>

<p>It lacks customization options though. In most of the sites I work on, there are a few pages that don’t get linked from the menus because they’re specialty pages. It could be a “thank you for purchasing” page, or a landing page for traffic from a specific site or campaign.</p>

<p>I’ve come up with a quick modification that lets you hide pages from the 404 listing by setting a field in the page’s metadata.</p>

<a class="read-more" href="/how-to/hide-pages-404-genesis-theme-wordpress/#more">Continue Reading &raquo;</a>
    
    
  </div>

</article>

<article class="home">
  <h2>
    <a href="/errors/dfs-properties-cannot-be-set-namespace-server-access-denied/">DFS: Properties cannot be set on the namespace server - Access is denied</a>
  </h2>
   	 <div class="byline">
		
		<time datetime="2012-11-16T21:41:49-05:00"><i class="fa fa-calendar"></i>
		November 16, 2012
		 </time>
		
		 <span class="comment-count"><i class="fa fa-comment"></i> <a data-disqus-identifier="17a315da-6885-410c-b1b8-1322e7af9ede" href="/errors/dfs-properties-cannot-be-set-namespace-server-access-denied/#disqus_thread">Comments</a></span>
		 
	</div>
	
			 


  <div class="post-content">
    
    
    <p>I ran across a strange problem the other day with DFS. I needed to override the referral ordering for a namespace server, but the change wouldn’t take. I got a status of Error during the <em>Commit changes</em> task. In the detail, it showed <code>Properties cannot be set on the namespace server \\SERVER.domain.local\Share. Access is denied</code>.</p>

<p><a href="/images/post/dfs-properties-cannot-be-set-namespace-server-access-denied/dfs-access-is-denied-namespace-server.png" rel="lightbox-dfs" title="Properties cannot be set on the namespace server - Access is denied"><img src="/images/post/dfs-properties-cannot-be-set-namespace-server-access-denied/dfs-access-is-denied-namespace-server.png" alt="Properties cannot be set on the namespace server - Access is denied" /></a></p>

<p>This error must be uncommon, because all of the search results are for a similar but differently worded error about changing the properties of a <em>folder</em> and that issue’s resolutions don’t apply here.</p>

<p>I finally figured out the problem, and thought I’d share!</p>

<a class="read-more" href="/errors/dfs-properties-cannot-be-set-namespace-server-access-denied/#more">Continue Reading &raquo;</a>
    
    
  </div>

</article>

<article class="home">
  <h2>
    <a href="/how-to/jtds-ntlm-auth-confluence-sql-server/">Use jTDS NTLM Authentication in Confluence with SQL Server</a>
  </h2>
   	 <div class="byline">
		
		<time datetime="2012-11-05T11:58:13-05:00"><i class="fa fa-calendar"></i>
		November 05, 2012
		 </time>
		
		 <span class="comment-count"><i class="fa fa-comment"></i> <a data-disqus-identifier="bd8221f3-af92-424a-be81-ba4e46bf7b2b" href="/how-to/jtds-ntlm-auth-confluence-sql-server/#disqus_thread">Comments</a></span>
		 
	</div>
	
			 


  <div class="post-content">
    
    
    <p>I run Atlassian’s Confluence in several organizations. It’s a great product and runs on many platforms. Being a Windows admin I tend to stick to the existing Microsoft stack where possible, so I typically run Confluence on Windows against Microsoft SQL Server. The jTDS driver that comes with Confluence wants to use a SQL server user and can’t use NTLM/Windows authentication out of the box. With a few simple changes, we can have Confluence using NTLM auth to connect to SQL Server.</p>

<a class="read-more" href="/how-to/jtds-ntlm-auth-confluence-sql-server/#more">Continue Reading &raquo;</a>
    
    
  </div>

</article>

<article class="home">
  <h2>
    <a href="/how-to/send-mail-multiple-recipients-ruby-pony/">Send Mail to Multiple Recipients with Ruby & Pony</a>
  </h2>
   	 <div class="byline">
		
		<time datetime="2012-10-22T21:38:07-04:00"><i class="fa fa-calendar"></i>
		October 22, 2012
		 </time>
		
		 <span class="comment-count"><i class="fa fa-comment"></i> <a data-disqus-identifier="776a6cb4-ac26-4b51-bb17-3839ec739f2e" href="/how-to/send-mail-multiple-recipients-ruby-pony/#disqus_thread">Comments</a></span>
		 
	</div>
	
			 


  <div class="post-content">
    
    
    
<p>One of my favorite ways to send mail from Ruby is through the <a href="http://rubygems.org/gems/pony">Pony gem</a>. If you haven’t used it, it’s definitely worth a look. I recently found the need to send mail to multiple recipients, and I couldn’t figure out how based on their documentation.</p>

<a class="read-more" href="/how-to/send-mail-multiple-recipients-ruby-pony/#more">Continue Reading &raquo;</a>
    
    
  </div>

</article>

<article class="home">
  <h2>
    <a href="/how-to/configure-viking-ata-100-cortelco-8211-analog-telephone-adapter/">Configure a Viking ATA-100 / Cortelco 8211 Analog Telephone Adapter</a>
  </h2>
   	 <div class="byline">
		
		<time datetime="2012-10-13T23:26:17-04:00"><i class="fa fa-calendar"></i>
		October 13, 2012
		 </time>
		
		 <span class="comment-count"><i class="fa fa-comment"></i> <a data-disqus-identifier="9186964b-36a9-4e4d-80cd-3b987117ba66" href="/how-to/configure-viking-ata-100-cortelco-8211-analog-telephone-adapter/#disqus_thread">Comments</a></span>
		 
	</div>
	
			 


  <div class="post-content">
    
    
    
<p>Last week I had to diagnose a VoIP problem for a client wherein an intercom which acted as a regular POTS “phone” was connected to their IP-based PBX. The intermediary was a small box called an Analog Telephone Adapter. The Viking model number appears to be <a href="http://amzn.to/1LZjRXD" rel="nofollow" target="_blank" onClick="ga('send', 'event', 'Product', 'click', 'ATA-100');">ATA-100</a> while the actual Cortelco model is 8211 or <a href="http://amzn.to/1LZjRXD" rel="nofollow" target="_blank" onClick="ga('send', 'event', 'Product', 'click', '821121-ATA-PAK');">821121-ATA-PAK</a>. The ATA registers as a generic SIP device with the PBX, but it wasn’t registering. I needed to log in to the web interface, and the client didn’t have the login.</p>

<a class="read-more" href="/how-to/configure-viking-ata-100-cortelco-8211-analog-telephone-adapter/#more">Continue Reading &raquo;</a>
    
    
  </div>

</article>

<article class="home">
  <h2>
    <a href="/how-to/confluence-jira-windows-upgrades/">Simplify Confluence and JIRA Upgrades on Windows</a>
  </h2>
   	 <div class="byline">
		
		<time datetime="2012-09-26T20:04:44-04:00"><i class="fa fa-calendar"></i>
		September 26, 2012
		 </time>
		
		 <span class="comment-count"><i class="fa fa-comment"></i> <a data-disqus-identifier="a731b830-d022-4b48-83f9-1784d34a293c" href="/how-to/confluence-jira-windows-upgrades/#disqus_thread">Comments</a></span>
		 
	</div>
	
			 


  <div class="post-content">
    
    
    <p>The new installer for Confluence and JIRA on Windows simplifies upgrades, but it also overwrites added or modified files in your program directory. If you have added or modified a lot of files, it can be tedious to restore those modifications after the upgrade. To that end, I’ve written a simple powershell script which will back up all of the modified files and then optionally restore the files once the upgrade is complete.</p>

<a class="read-more" href="/how-to/confluence-jira-windows-upgrades/#more">Continue Reading &raquo;</a>
    
    
  </div>

</article>

<article class="home">
  <h2>
    <a href="/how-to/powershell-remoting-group-policy/">Enable Powershell Remoting via Group Policy</a>
  </h2>
   	 <div class="byline">
		
		<time datetime="2012-09-16T22:29:44-04:00"><i class="fa fa-calendar"></i>
		September 16, 2012
		 </time>
		
		 <span class="comment-count"><i class="fa fa-comment"></i> <a data-disqus-identifier="ebe8b75d-56f2-4ae4-82df-1fbd4fb5ffdb" href="/how-to/powershell-remoting-group-policy/#disqus_thread">Comments</a></span>
		 
	</div>
	
			 


  <div class="post-content">
    
    
    <p>Powershell really is a game changer when it comes management and scripting on Windows, but one of the areas where it really shines is in its remoting capability. Powershell remoting lets you connect to a remote system and run commands locally, then returns the results to the calling machine. This can be done as an automated block or as an interactive session.</p>

<p>Remoting requires Powershell 2.0 which comes built-in on Windows 7 and Windows 2008 R2, but it needs to be installed on Windows Vista / Server 2008 and below. The WinRM service will also have to be configured and enabled.</p>

<p>I’ll show you how to accomplish this with group policy for the range of operating systems that can run it.</p>

<p><strong>Update 2013/02/20:</strong> I have confirmed that this method is working on Server 2012 (core and GUI) as well.</p>

<p><strong>Update 2013/05/07:</strong> With the help of Jacob in the comments below, I was able to fix a problem in the VB Script. Since Powershell requires the .NET framework, this whole process will fail on Windows 2003 / XP if .NET is not installed. The VB Script now installs .NET as part of the process. The <a href="https://gist.github.com/briantist/3734447">GitHub Gist</a> has been updated. Thanks Jacob!</p>

<p><strong>Update 2013/10/09:</strong> Updated the name of the WinRM policy setting based on user comments. Thanks to Micahel M. of Miller Computers and Giorgi Gordeziani.</p>

<a class="read-more" href="/how-to/powershell-remoting-group-policy/#more">Continue Reading &raquo;</a>
    
    
  </div>

</article>

<article class="home">
  <h2>
    <a href="/how-to/fix-incorrect-dates-in-utorrent/">Fix Incorrect Dates in uTorrent</a>
  </h2>
   	 <div class="byline">
		
		<time datetime="2012-09-11T20:29:35-04:00"><i class="fa fa-calendar"></i>
		September 11, 2012
		 </time>
		
		 <span class="comment-count"><i class="fa fa-comment"></i> <a data-disqus-identifier="010664af-1f0b-4271-a33c-72ccb9a40a0e" href="/how-to/fix-incorrect-dates-in-utorrent/#disqus_thread">Comments</a></span>
		 
	</div>
	
			 


  <div class="post-content">
    
    
    <p>A bug in uTorrent (which may or may not have been fixed) causes the <code>Added On</code> and <code>Completed On</code> dates to be incorrect after a reboot. If you are using fuzzy dates the affected torrents will appear to have been added/completed “less than a minute ago” or if you turned off fuzzy dates, you’ll see that the dates are set in the future.</p>

<p>I’ve written a short ruby script that will correct those dates (more or less) on Windows. I’m sharing this as a <a href="https://gist.github.com/3701814">GitHub gist</a> for easy downloading.</p>

<a class="read-more" href="/how-to/fix-incorrect-dates-in-utorrent/#more">Continue Reading &raquo;</a>
    
    
  </div>

</article>


</div>


    
<div id="disqus_thread"></div>


 <script id="dsq-count-scr" src="//briantist.disqus.com/count.js" async></script>





		<footer>
			<hr/>
			<p>
				&copy; 2012 &ndash; 2015 Brian Scholer &nbsp;&middot;&nbsp; <a rel="nofollow" target="_blank" href="https://cloudflare.ipv6-test.com/validate.php?url=www.briantist.com"><img src="https://ajax.cloudflare.com/cdn-cgi/custom/images/button-ipv6-80x15.png" alt="ipv6 ready" title="ipv6 ready" border="0" style="vertical-align: middle;" width="80" height="15" /></a>
			</p>
		</footer>
	</div>

	<script type="text/javascript" src="/assets/resources/jquery/jquery.min.js"></script>
	<script type="text/javascript" src="/assets/resources/slimbox2/slimbox2.js"></script>
	<script type="text/javascript" src="/assets/resources/bootstrap/js/bootstrap.min.js"></script>
	
</body>
</html>
